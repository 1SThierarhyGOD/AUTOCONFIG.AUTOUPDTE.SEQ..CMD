<Project>
  <Import Project="..\Directory.Build.targets" />

  <ItemGroup>
    <None Include="$(RepositoryEngineeringDir)testing\.runsettings" CopyToOutputDirectory="PreserveNewest" Condition="'$(DeployRunSettingsFile)' == 'true'" />
  </ItemGroup>

  <Target Name="ZipTestArchive" AfterTargets="PrepareForRun" Condition="'$(ArchiveTests)' == 'true' and '$(IsTestSupportProject)' != 'true' and '$(IsHelixReadyTestProject)' == 'true'">
    <Error Condition="'$(TestArchiveTestsDir)' == ''" Text="TestArchiveTestsDir property to archive the test folder must be set." />

    <MakeDir Directories="$(TestArchiveTestsDir)" />
    <ZipDirectory SourceDirectory="$(OutDir)"
                  DestinationFile="$([MSBuild]::NormalizePath('$(TestArchiveTestsDir)', '$(MSBuildProjectName).zip'))"
                  Overwrite="true" />
  </Target>
</Project>
